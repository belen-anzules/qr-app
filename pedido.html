<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mi Pedido - Macro Fit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header class="header-clean">
    <div class="header-title-container">
        <a href="menu.html" style="text-decoration:none; margin-right:15px; font-size:24px;">‚Äπ</a>
        <h2>RESUMEN</h2>
    </div>
    <div style="width: 40px;"></div> 
</header>

<main class="menu"> 
    <div id="pedido-lista">
        </div> 
    <div style="height: 180px;"></div>
</main>

<div class="cart-footer">
    <button class="btn btn-secondary" onclick="window.location.href='menu.html'">+ A√±adir m√°s platos</button>
    <button class="btn btn-primary" onclick="finalizarCompra()">Finalizar Compra</button>
</div>

<div id="modalConfirmacion" class="modal">
    <div class="modal-card">
        <div style="font-size: 50px; margin-bottom: 10px;">ü•ë</div>
        <h3 style="color: #2D3436; font-size: 1.5rem;">¬°Pedido Recibido!</h3>
        <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">
            Ac√©rcate a caja para cancelar tu pedido y empezar a cocinarlo.
        </p>
        
        <div class="codigo-contenedor">
            <p style="font-size: 0.7rem; color: #888; margin-bottom: 5px; font-weight: bold; letter-spacing: 1px;">C√ìDIGO DE PEDIDO</p>
            <div id="codigoPedido" class="codigo"></div>
        </div>
        
        <button class="btn btn-primary" onclick="limpiarYRegresar()">Entendido</button>
    </div>
</div>

<script>
    // 1. Mostrar pedido al cargar
    window.onload = () => {
        const lista = document.getElementById('pedido-lista');
        const cart = JSON.parse(localStorage.getItem('cart')) || [];

        if(cart.length === 0) {
            lista.innerHTML = `<div class="card" style="padding:40px; text-align:center; color:#999;">Tu carrito est√° vac√≠o</div>`;
            return;
        }

        lista.innerHTML = "";
        cart.forEach((item, index) => {
            lista.innerHTML += `
                <div class="card" style="padding:15px; margin-bottom:12px; display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <strong style="display:block; font-size:1.1rem;">${item.nombre || 'Bowl Saludable'}</strong>
                        <span style="color:#4CAF50; font-weight:bold;">$${item.total || '7.99'}</span>
                    </div>
                    <button onclick="eliminarPlato(${index})" style="background:none; border:none; font-size:20px;">üóëÔ∏è</button>
                </div>
            `;
        });
    };

    function eliminarPlato(index) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        location.reload();
    }

    function finalizarCompra() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        if(cart.length === 0) {
            alert("El carrito est√° vac√≠o");
            return;
        }

        // Generar n√∫mero aleatorio de 6 d√≠gitos
        const codigo = Math.floor(100000 + Math.random() * 900000);
        document.getElementById("codigoPedido").innerText = codigo;
        document.getElementById("modalConfirmacion").style.display = "flex";
    }

    function limpiarYRegresar() {
        localStorage.removeItem('cart'); 
        window.location.href = 'menu.html';
    }
</script>

</body>
</html>